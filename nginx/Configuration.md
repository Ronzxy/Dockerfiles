# Configuration

## IF 判断条件

### 正则表达式匹配

* ==    : 等值比较;
* ~     : 与指定正则表达式模式匹配时返回“真”，判断匹配与否时区分字符大小写；
* ~*    : 与指定正则表达式模式匹配时返回“真”，判断匹配与否时不区分字符大小写；
* !~    : 与指定正则表达式模式不匹配时返回“真”，判断匹配与否时区分字符大小写；
* !~*   : 与指定正则表达式模式不匹配时返回“真”，判断匹配与否时不区分字符大小写；


### 文件及目录判断

* -f, !-f：判断指定的路径是否为存在且为文件；
* -d, !-d：判断指定的路径是否为存在且为目录；
* -e, !-e：判断指定的路径是否存在，文件或目录均可；
* -x, !-x：判断指定路径的文件是否存在且可执行；

### 判断客户端地址
if ($remote_addr !~* ^(172)\.(16)\.(1)\.(11)$) {
    return 444;
}

### 通过 IP 地址限制访问
Nginx 可以基于指定的客户端 IP 地址或地址段允许或拒绝访问。在 stream 上下文或 server 块中使用 allow 或 deny 指令可以允许或拒绝访问：

stream {
    ...
    server {
        listen 80;

        deny   192.168.0.0/24;
        allow  192.168.1.0/24;
        allow  2001:0db8::/32;
        deny   all;
    }
}